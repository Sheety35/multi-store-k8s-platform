apiVersion: v1
kind: ConfigMap
metadata:
  name: plugin-install-script
data:
  install-woocommerce.sh: |
    #!/bin/bash
    # Wait for WordPress to be ready (Bitnami script might have already done this)
    
    echo "Checking for WooCommerce..."
    
    # Try to install WooCommerce
    # We use '|| true' to ensure the script doesn't fail the pod startup if there's a transient issue
    if ! wp plugin is-installed woocommerce; then
        echo "Installing WooCommerce..."
        wp plugin install woocommerce --activate
        echo "WooCommerce installed."
    else
        echo "WooCommerce already installed."
    fi

    # Install storefront theme for better compatibility
    if ! wp theme is-installed storefront; then
        echo "Installing Storefront theme..."
        wp theme install storefront --activate
        echo "Storefront theme installed."
    fi
